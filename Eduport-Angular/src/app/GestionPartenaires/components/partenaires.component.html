<section class="container py-5">
  <h2 class="text-center">Gestion des Partenaires</h2>

  <!-- Affichage des messages -->
  <div *ngIf="message" class="alert" [ngClass]="{'alert-danger': isError, 'alert-success': !isError}">
    {{ message }}
  </div>

  <!-- Formulaire pour ajouter un partenaire -->
  <form [formGroup]="partenaireForm" (ngSubmit)="onSubmit()" class="mb-4">
    <div class="row">
      <div class="col-md-6">
        <label class="form-label" for="nom">Nom *</label>
        <input type="text" id="nom"formControlName="nom" class="form-control" placeholder="Nom du partenaire" />
        <div *ngIf="partenaireForm.get('nom')?.invalid && (partenaireForm.get('nom')?.dirty || partenaireForm.get('nom')?.touched)" class="text-danger">
          <div *ngIf="partenaireForm.get('nom')?.errors?.['required']">Le nom est obligatoire.</div>
        </div>
      </div>

      <div class="col-md-6">
        <label class="form-label" for="type">Type *</label>
        <input type="text" id="type" formControlName="type" class="form-control" placeholder="Type de partenaire" />
        <div *ngIf="partenaireForm.get('type')?.invalid && (partenaireForm.get('type')?.dirty || partenaireForm.get('type')?.touched)" class="text-danger">
          <div *ngIf="partenaireForm.get('type')?.errors?.['required']">Le type est obligatoire.</div>
        </div>
      </div>
    </div>

    <div class="row mt-3">
      <div class="col-md-12">
        <label class="form-label" for="description">Description *</label>
        <textarea formControlName="description" id="description" class="form-control" rows="3" placeholder="Description"></textarea>
        <div *ngIf="partenaireForm.get('description')?.invalid && (partenaireForm.get('description')?.dirty || partenaireForm.get('description')?.touched)" class="text-danger">
          <div *ngIf="partenaireForm.get('description')?.errors?.['required']">La description est obligatoire.</div>
        </div>
      </div>
    </div>

    <div class="row mt-3">
      <div class="col-md-6">
        <label class="form-label" for="start">Date de début *</label>
        <input type="date" id="start"  formControlName="startDate" class="form-control" />
      </div>

      <div class="col-md-6">
        <label class="form-label" for="end">Date de fin *</label>
        <input type="date" id="end" formControlName="endDate" class="form-control" />
      </div>
    </div>

    <div class="form-check mt-3">
      <input type="checkbox" id="active" class="form-check-input" formControlName="isActive" />
      <label class="form-check-label" for="active" >Activer ce partenaire</label>
    </div>

    <button class="btn btn-primary mt-4" type="submit">Ajouter Partenaire</button>
  </form>
  <div class="d-flex align-items-center mb-3">
    <label for="sortField" class="me-2">Trier par :</label>
    <select id="sortField" #sortField >
      <option value="nom">Nom</option>
      <option value="type">Type</option>
      <option value="startDate">Date de début</option>
      <option value="endDate">Date de fin</option>
    </select>

    <label for="sortDirection" class="ms-3 me-2">Ordre :</label>
    <select id="sortDirection" #sortDirection>
      <option value="asc">Ascendant</option>
      <option value="desc">Descendant</option>
    </select>

    <button class="btn btn-primary ms-3" (click)="sortPartenaires(sortField.value, sortDirection.value)">
      Trier
    </button>

  </div>
  <div class="mb-3">
    <input
      type="text"
      class="form-control"
      (input)="onInputChange($event)"
      placeholder="Rechercher par nom"
    />
  </div>

  <!-- Tableau des partenaires -->
  <table class="table table-striped mt-4">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Type</th>
        <th>Description</th>
        <th>Date Début</th>
        <th>Date Fin</th>
        <th>Statut</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let partenaire of partenaires">
        <td>{{ partenaire.nom }}</td>
        <td>{{ partenaire.type }}</td>
        <td>{{ partenaire.description }}</td>
        <td>{{ partenaire.startDate }}</td>
        <td>{{ partenaire.endDate }}</td>
        <td>
          <span class="badge" [ngClass]="{'bg-success': partenaire.isActive, 'bg-danger': !partenaire.isActive}">
            {{ partenaire.isActive ? 'Actif' : 'Inactif' }}
          </span>

        </td>
        <td>
          <button class="btn btn-sm btn-danger" (click)="deletePartenaire(partenaire.id)">
            Supprimer
          </button>
          <button class="btn btn-sm btn-warning" (click)="toggleActivation(partenaire.id, !partenaire.isActive)">
            {{ partenaire.isActive ? 'Désactiver' : 'Activer' }}
          </button>
        </td>
      </tr>

    </tbody>
  </table>
  <div class="pagination d-flex justify-content-end">
    <button class="btn btn-primary" (click)="goToPreviousPage()" [disabled]="currentPage <= 0">
      Précédent
    </button>
    <button class="btn btn-primary ms-2" (click)="goToNextPage()">
      Suivant
    </button>
  </div>



</section>
